# Домашнее задание к занятию «Сетевое взаимодействие в K8S. Часть 2»
### Задание 1. Создать Deployment приложений backend и frontend
1) Создать Deployment приложения frontend из образа nginx с количеством реплик 3 шт.
2) Создать Deployment приложения backend из образа multitool.
3) Добавить Service, которые обеспечат доступ к обоим приложениям внутри кластера.
4) Продемонстрировать, что приложения видят друг друга с помощью Service.
5) Предоставить манифесты Deployment и Service в решении, а также скриншоты или вывод команды п.4.

Создаём пространство имён:
```
vagrant@server:~/manifests/04_dz_kuber_1.5$ kubectl apply -f ~/manifests/04_dz_kuber_1.5/01_namespace.yml
vagrant@server:~/manifests/04_dz_kuber_1.5$ kubectl get ns
NAME              STATUS   AGE
kube-system       Active   3d2h
kube-public       Active   3d2h
kube-node-lease   Active   3d2h
default           Active   3d2h
lesson4           Active   3d2h
ingress           Active   3d2h
dz5               Active   31s
```
Поднимем деплоймент фронтэнда:
```
kubectl apply -f ~/manifests/04_dz_kuber_1.5/02_deploy_svc_nginx.yml
deployment.apps/dpl-nginx-dz5 created
service/svc-fe-dz5 created

vagrant@server:~/manifests/04_dz_kuber_1.5$ kubectl get pods -n dz5 -o wide
NAME                             READY   STATUS    RESTARTS   AGE     IP            NODE          NOMINATED NODE   READINESS GATES
dpl-nginx-dz5-6ab455c5e7-5eudj   1/1     Running   0          2m40s   10.1.162.11   microk8s-03   <none>           <none>
dpl-nginx-dz5-6ab455c5e7-dj4hr   1/1     Running   0          2m40s   10.1.162.10   microk8s-03   <none>           <none>
dpl-nginx-dz5-6ab455c5e7-j3m4m   1/1     Running   0          2m40s   10.1.162.12   microk8s-03   <none>           <none>

vagrant@server:~/manifests/04_dz_kuber_1.5$ kubectl get deployments -n dz5 -o wide
NAME            READY   UP-TO-DATE   AVAILABLE   AGE     CONTAINERS   IMAGES         SELECTOR
dpl-nginx-dz5   3/3     3            3           3m20s   nginx        nginx:1.19.2   app=fe-dz5

vagrant@server:~/manifests/04_dz_kuber_1.5$ kubectl get svc -n dz5 -o wide
NAME         TYPE        CLUSTER-IP      EXTERNAL-IP   PORT(S)   AGE     SELECTOR
svc-fe-dz5   ClusterIP   10.161.193.14   <none>        80/TCP    4m27s   app=fe-dz5

vagrant@server:~/manifests/04_dz_kuber_1.5$ kubectl get ep -n dz5 -o wide
NAME         ENDPOINTS                                      AGE
svc-fe-dz5   10.1.162.10:80,10.1.162.11:80,10.1.162.12:80   4m56s
```
Также тестовый ПОД:
```
vagrant@server:~/manifests/04_dz_kuber_1.5$ kubectl apply -f ~/manifests/04_dz_kuber_1.5/03_pod_multitool.yml
pod/pod-multitool-dz5 created

vagrant@server:~/manifests/04_dz_kuber_1.5$ kubectl get pods -n dz5 -o wide
NAME                             READY   STATUS    RESTARTS   AGE   IP            NODE          NOMINATED NODE   READINESS GATES
dpl-nginx-dz5-6ab455c5e7-5eudj   1/1     Running   0          12m   10.1.162.11   microk8s-03   <none>           <none>
dpl-nginx-dz5-6ab455c5e7-dj4hr   1/1     Running   0          12m   10.1.162.10   microk8s-03   <none>           <none>
dpl-nginx-dz5-6ab455c5e7-j3m4m   1/1     Running   0          12m   10.1.162.12   microk8s-03   <none>           <none>
pod-multitool-dz5                1/1     Running   0          42s   10.1.162.18   microk8s-03   <none>           <none>
```
Протестим:
```
vagrant@server:~/manifests/04_dz_kuber_1.5$ kubectl exec -n dz5 pod-multitool-dz5 -- curl svc-fe-dz5
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
100   612  100   612    0     0   185k      0 --:--:-- --:--:-- --:--:--  298k
<!DOCTYPE html>
<html>
<head>
<title>Welcome to nginx!</title>
<style>
    body {
        width: 35em;
        margin: 0 auto;
        font-family: Tahoma, Verdana, Arial, sans-serif;
    }
</style>
</head>
<body>
<h1>Welcome to nginx!</h1>
<p>If you see this page, the nginx web server is successfully installed and
working. Further configuration is required.</p>

<p>For online documentation and support please refer to
<a href="http://nginx.org/">nginx.org</a>.<br/>
Commercial support is available at
<a href="http://nginx.com/">nginx.com</a>.</p>

<p><em>Thank you for using nginx.</em></p>
</body>
</html>
```
И бэкенд:
```
vagrant@server:~/manifests/04_dz_kuber_1.5$ kubectl apply -f ~/manifests/04_dz_kuber_1.5/04_deploy_svc_multitool.yml
deployment.apps/dpl-multitool-dz5 created
service/svc-be-dz5 created
vagrant@server:~/manifests/04_dz_kuber_1.5$ kubectl get pods -n dz5 -o wide
NAME                                 READY   STATUS    RESTARTS   AGE   IP            NODE          NOMINATED NODE   READINESS GATES
dpl-nginx-dz5-6ab455c5e7-5eudj       1/1     Running   0          21m   10.1.162.11   microk8s-03   <none>           <none>
dpl-nginx-dz5-6ab455c5e7-dj4hr       1/1     Running   0          21m   10.1.162.10   microk8s-03   <none>           <none>
dpl-nginx-dz5-6ab455c5e7-j3m4m       1/1     Running   0          21m   10.1.162.12   microk8s-03   <none>           <none>
pod-multitool-dz5                    1/1     Running   0          9m    10.1.162.18   microk8s-03   <none>           <none>
dpl-multitool-dz5-56f374d4b5-6dpth   1/1     Running   0          21s   10.1.162.19   microk8s-03   <none>           <none>
vagrant@server:~/manifests/04_dz_kuber_1.5$ kubectl get deployments -n dz5 -o wide
NAME                READY   UP-TO-DATE   AVAILABLE   AGE   CONTAINERS   IMAGES                    SELECTOR
dpl-nginx-dz5       3/3     3            3           21m   nginx        nginx:1.19.2              app=fe-dz5
dpl-multitool-dz5   1/1     1            1           50s   multitool    wbitt/network-multitool   app=be-dz5
vagrant@server:~/manifests/04_dz_kuber_1.5$ kubectl get svc -n dz5 -o wide
NAME         TYPE        CLUSTER-IP       EXTERNAL-IP   PORT(S)   AGE   SELECTOR
svc-fe-dz5   ClusterIP   10.161.193.14    <none>        80/TCP    22m   app=fe-dz5
svc-be-dz5   ClusterIP   10.161.193.122   <none>        80/TCP    45s   app=be-dz5
vagrant@server:~/manifests/04_dz_kuber_1.5$ kubectl get ep -n dz5 -o wide
NAME         ENDPOINTS                                      AGE
svc-fe-dz5   10.1.162.10:80,10.1.162.11:80,10.1.162.12:80   22m
svc-be-dz5   10.1.162.19:80                                 52s
```




